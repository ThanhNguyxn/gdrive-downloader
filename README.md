<h1 align="center">ğŸš€ GDrive Downloader</h1>

<p align="center">
  <b>Download view-only files from Google Drive</b><br>
  <i>ğŸ“„ Docs | ğŸ“Š Sheets | ğŸ¨ Slides | ğŸ“‘ PDFs | ğŸ¬ Videos</i>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/version-2.0.1-blue?style=flat-square" alt="Version"/>
  <img src="https://img.shields.io/badge/license-MIT-green?style=flat-square" alt="License"/>
</p>

<p align="center">
  <a href="https://github.com/ThanhNguyxn/gdrive-downloader/raw/main/release/gdrive-downloader-v2.0.1.zip">
    <img src="https://img.shields.io/badge/â¬‡ï¸_Download_v2.0.1-Click_Here-blue?style=for-the-badge&logo=google-drive&logoColor=white" alt="Download"/>
  </a>
</p>

<p align="center">
  <img src="https://img.shields.io/badge/Chrome-4285F4?style=flat-square&logo=googlechrome&logoColor=white" alt="Chrome"/>
  <img src="https://img.shields.io/badge/Edge-0078D7?style=flat-square&logo=microsoftedge&logoColor=white" alt="Edge"/>
  <img src="https://img.shields.io/badge/Brave-FB542B?style=flat-square&logo=brave&logoColor=white" alt="Brave"/>
  <img src="https://img.shields.io/badge/Opera-FF1B2D?style=flat-square&logo=opera&logoColor=white" alt="Opera"/>
  <img src="https://img.shields.io/badge/Vivaldi-EF3939?style=flat-square&logo=vivaldi&logoColor=white" alt="Vivaldi"/>
</p>

<p align="center">
  <a href="https://buymeacoffee.com/thanhnguyxn">
    <img src="https://img.shields.io/badge/Buy_Me_A_Coffee-FFDD00?style=for-the-badge&logo=buy-me-a-coffee&logoColor=black" alt="Buy Me a Coffee"/>
  </a>
</p>

---

## âœ¨ Features (v2.0)

<table>
<tr>
<td width="50%">

### ğŸ“„ Google Docs
- â¬‡ï¸ **Download as PDF** (High Res)
- ğŸ“¦ **Download as ZIP** (All pages)
- ğŸ–¼ï¸ **Extract as Images**
- ğŸ–¨ï¸ **Try Native Print** (Selectable Text)
- ğŸ“ **Extract Text Only** (Raw Text)
- ğŸ“± Open Mobile View

</td>
<td width="50%">

### ğŸ“Š Google Sheets
- ğŸŒ **Open HTML View** (Copy Data)
- ğŸ“¥ **Try Export CSV** (Direct Export)
- ğŸ–¨ï¸ Print to PDF

</td>
</tr>
<tr>
<td width="50%">

### ğŸ¨ Google Slides
- â¬‡ï¸ **Download as PDF**
- âœ’ï¸ **Export Page as SVG** (Vector)
- ğŸ“¦ **Download as ZIP**
- ğŸ–¼ï¸ **Extract as Images**
- ğŸ“ **Extract Text Only**
- ğŸ­ Open HTML Present

</td>
<td width="50%">

### ğŸ¬ Protected Videos
- ğŸ“¹ **Auto-detect Video & Audio**
- â¬‡ï¸ **Download Both Tracks**
- ğŸ”— Direct download links
- ğŸ”§ **Merge Tool Integration**

</td>
</tr>
</table>

---

## ğŸŒ Supported Browsers

| Browser | Status | Installation |
|---------|--------|--------------|
| ![Chrome](https://img.shields.io/badge/-Chrome-4285F4?logo=googlechrome&logoColor=white) | âœ… Full Support | Developer Mode |
| ![Edge](https://img.shields.io/badge/-Edge-0078D7?logo=microsoftedge&logoColor=white) | âœ… Full Support | Developer Mode |
| ![Brave](https://img.shields.io/badge/-Brave-FB542B?logo=brave&logoColor=white) | âœ… Full Support | Developer Mode |
| ![Opera](https://img.shields.io/badge/-Opera-FF1B2D?logo=opera&logoColor=white) | âœ… Full Support | Developer Mode |
| ![Vivaldi](https://img.shields.io/badge/-Vivaldi-EF3939?logo=vivaldi&logoColor=white) | âœ… Full Support | Developer Mode |

---

## ğŸ“¥ Installation

<details>
<summary><b>ğŸ”µ Chrome / Edge / Brave / Opera / Vivaldi</b></summary>

1. Download or Clone this repository
2. Open browser extensions page:
   - **Chrome**: `chrome://extensions/`
   - **Edge**: `edge://extensions/`
   - **Brave**: `brave://extensions/`
   - **Opera**: `opera://extensions/`
   - **Vivaldi**: `vivaldi://extensions/`
3. Enable **Developer mode**
4. Click **Load unpacked**
5. Select the `extension/` folder
6. Done! ğŸ‰

</details>

---

## ğŸ“– Usage Guide

### ğŸ“„ For Google Docs
| Feature | Action |
|:-------:|--------|
| **PDF** | Click **Download as PDF** for standard image-based PDF. |
| **Selectable** | Click **Try Native Print** to attempt a selectable text PDF. |
| **Text** | Click **Extract Text Only** to copy raw text to clipboard. |

### ğŸ“Š For Google Sheets
| Feature | Action |
|:-------:|--------|
| **Excel** | Click **Open HTML View** -> Select All -> Copy -> Paste to Excel. |
| **CSV** | Click **Try Export CSV** for direct download (if available). |

### ğŸ¨ For Google Slides
| Feature | Action |
|:-------:|--------|
| **Vector** | Click **Export Page as SVG** for high-quality vector export. |
| **Images** | Click **Extract as Images** or **Download as ZIP** for all slides. |

### ğŸ¬ For Videos
| Step | Action |
|:----:|--------|
| 1ï¸âƒ£ | Open video on Google Drive & **Play it** âš ï¸ |
| 2ï¸âƒ£ | Click extension icon -> Wait for URLs to appear |
| 3ï¸âƒ£ | Click **Download Video + Audio** (Downloads 2 files) |
| 4ï¸âƒ£ | Use **Open Online Merge Tool** to combine them |

---

## âŒ¨ï¸ Keyboard Shortcuts

| Shortcut | Action |
|:--------:|--------|
| `Alt + P` | Download PDF |
| `Alt + Z` | Download ZIP |
| `Alt + S` | Export SVG (Slides only) |

---

## âš™ï¸ Options

| Option | Description |
|--------|-------------|
| ğŸ” **High Resolution** | Creates higher quality PDFs (Slower) |
| ğŸ“œ **Auto-scroll** | Automatically loads all pages before downloading |
| ğŸ’¾ **Persistence** | Settings are saved automatically |

---

## ğŸ—ï¸ Technical Architecture

This extension leverages advanced browser capabilities to bypass view-only restrictions legally and safely.

### ğŸ”§ Core Logic

#### 1. PDF Generation (Canvas & Native)
- **Standard Mode:** Iterates through the document's canvas elements, captures them as high-quality images, and compiles them into a PDF using `jsPDF`.
- **Native Print Mode:** Injects specific CSS (`@media print`) to override Google's "display: none" on text layers, forcing the browser's native print dialog to recognize and render the selectable text.

#### 2. Text & Data Extraction
- **Docs/Slides:** Uses DOM traversal to locate specific container classes (e.g., `.kix-lineview-content` for Docs, `g text` for Slides) and extracts raw text content, bypassing the clipboard restrictions.
- **Sheets:** Manipulates the spreadsheet URL to access the `/htmlview` endpoint, which renders a copy-paste friendly HTML version of the data.

#### 3. Media Detection
- **Video/Audio:** Uses `MutationObserver` to watch for media player initialization and intercepts network request patterns to identify the underlying `googlevideo.com` stream URLs for both video and audio tracks.

#### 4. Vector Export (SVG)
- **Slides:** Scrapes the SVG nodes directly from the Google Slides rendering layer (`.punch-viewer-content`) and serializes them into a standalone `.svg` file, preserving vector quality.

---

## ğŸ“‚ Project Structure

```bash
gdrive-downloader/
â”œâ”€â”€ ğŸ“‚ .github/             # GitHub templates & workflows
â”œâ”€â”€ ğŸ“‚ extension/           # Source code
â”‚   â”œâ”€â”€ ğŸ“‚ background/      # Service worker (Event handling)
â”‚   â”œâ”€â”€ ğŸ“‚ content/         # Content scripts (Page manipulation)
â”‚   â”‚   â””â”€â”€ content.js      # Main logic (PDF, Text, Media extraction)
â”‚   â”œâ”€â”€ ğŸ“‚ lib/             # Third-party libraries
â”‚   â”‚   â”œâ”€â”€ jspdf.umd.min.js # PDF generation
â”‚   â”‚   â””â”€â”€ jszip.min.js     # ZIP creation
â”‚   â”œâ”€â”€ ğŸ“‚ popup/           # Extension UI
â”‚   â”‚   â”œâ”€â”€ popup.html      # Structure
â”‚   â”‚   â”œâ”€â”€ popup.css       # Styling (Glassmorphism)
â”‚   â”‚   â””â”€â”€ popup.js        # UI Logic & Messaging
â”‚   â””â”€â”€ manifest.json       # Extension Configuration (V3)
â”œâ”€â”€ ğŸ“‚ release/             # Pre-built releases (.zip)
â”œâ”€â”€ .gitignore              # Git ignore rules
â”œâ”€â”€ LICENSE                 # MIT License
â””â”€â”€ README.md               # Documentation
```

---

## âš ï¸ Disclaimer

> ğŸ”’ These tools are for **legitimate personal use only**!

| âœ… Allowed | âŒ Not Allowed |
|------------|----------------|
| Personal backups | Copyrighted content |
| Offline access | Unauthorized sharing |
| Educational materials | Commercial use |

---

## ğŸ’– Support

If you find this useful, please consider:

<p align="center">
  <a href="https://github.com/ThanhNguyxn/gdrive-downloader">â­ Star this repo</a>
  &nbsp;&nbsp;|&nbsp;&nbsp;
  <a href="https://buymeacoffee.com/thanhnguyxn">â˜• Buy me a coffee</a>
</p>

---

## ğŸ“œ License

MIT License - See [LICENSE](LICENSE) for details.

---

<p align="center">
  Made with â¤ï¸ by <a href="https://github.com/ThanhNguyxn"><b>Thanh Nguyen</b></a>
</p>
